{"version":3,"file":"static/chunks/809.aba0456ec5032652.js","mappings":"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","sources":["webpack://_N_E/./libs/bs-sdk/Emitter.ts","webpack://_N_E/./libs/bs-sdk/BsSdk.ts","webpack://_N_E/./libs/bs-sdk/components/b-provide/index.tsx","webpack://_N_E/./libs/bs-sdk/BsORM.ts","webpack://_N_E/./libs/bs-sdk/components/b-select-field/index.tsx","webpack://_N_E/./components/echarts/index.tsx","webpack://_N_E/./libs/bs-sdk/shared.ts","webpack://_N_E/./views/Home/index.tsx","webpack://_N_E/./views/Home/index.module.css","webpack://_N_E/<anon>"],"sourcesContent":["import { ParamsType } from \"./typestools\";\n\nexport class Emitter<CB extends (...args: any[]) => void> {\n  private events = new Set<CB>();\n  private lastEmitArgs: ParamsType<CB> | undefined;\n  constructor() {}\n\n  emitSync(...args: ParamsType<CB>) {\n    this.events.forEach((cb) => {\n      cb(...args);\n    });\n  }\n\n  emitLifeCycle(...args: ParamsType<CB>) {\n    this.lastEmitArgs = args;\n    return Promise.resolve().then(() => {\n      try {\n        this.emitSync(...args);\n      } catch (error) {\n        return Promise.reject(error);\n      }\n    });\n  }\n\n  emit(...args: ParamsType<CB>) {\n    return Promise.resolve().then(() => {\n      try {\n        this.emitSync(...args);\n      } catch (error) {\n        return Promise.reject(error);\n      }\n    });\n  }\n\n  on(cb: CB) {\n    if (this.lastEmitArgs) {\n      cb(...this.lastEmitArgs);\n    }\n    this.events.add(cb);\n    return () => {\n      this.off(cb);\n    };\n  }\n\n  wait() {\n    return new Promise<ParamsType<CB>>((resolve) => {\n      const cb = (...args: ParamsType<CB>) => {\n        resolve(args);\n        clear();\n      };\n      const clear = this.on(cb as CB);\n    });\n  }\n\n  off(cb: CB) {\n    this.events.delete(cb);\n  }\n\n  destroy() {\n    this.events.clear();\n  }\n}\n","import {\n  IEventCbCtx,\n  bitable,\n  Selection,\n  ITable,\n  IField,\n} from \"@lark-base-open/js-sdk\";\nimport { Emitter } from \"./Emitter\";\n\nexport type SelectionChangeEmitter = (event: IEventCbCtx<Selection>) => any;\nexport type InitEmitter = (sdk: BsSdk) => any;\n\nexport interface BIField extends IField {\n  name: string;\n}\n\nexport class BsSdk {\n  public readonly bitable = bitable;\n  public readonly base = bitable.base;\n  public activeTable: ITable | undefined;\n  // public readonly initEmitter = new Emitter<InitEmitter>();\n  public readonly selectionChangeEmitter =\n    new Emitter<SelectionChangeEmitter>();\n\n  constructor({\n    onSelectionChange = false,\n    immediatelySelectionChange = true,\n  } = {}) {\n    if (onSelectionChange) {\n      this.base.onSelectionChange(async (event) => {\n        this.activeTable = undefined;\n        this.selectionChangeEmitter.emitLifeCycle(event);\n      });\n    }\n    if (immediatelySelectionChange && onSelectionChange) {\n      this.getSelection().then((selection) => {\n        this.selectionChangeEmitter.emitSync({ data: selection });\n      });\n    }\n  }\n\n  async getRecordIds(table?: ITable) {\n    if (!table) table = await this.getActiveTable();\n    return await table.getRecordIdList();\n  }\n\n  async getRecordById(table: ITable, recordId: string) {\n    return await table.getRecordById(recordId);\n  }\n\n  async getActiveTable() {\n    if (this.activeTable) return this.activeTable;\n    this.activeTable = await bitable.base.getActiveTable();\n    return this.activeTable;\n  }\n\n  async getTableList() {\n    return await bitable.base.getTableList();\n  }\n\n  async getFieldList(table: ITable) {\n    const fieldList: BIField[] = await table.getFieldList();\n    for (let i = 0; i < fieldList.length; i++) {\n      const field = fieldList[i];\n      field.name = await field.getName();\n    }\n    return fieldList;\n  }\n\n  async getSelection(): Promise<Selection> {\n    return await bitable.base.getSelection();\n  }\n\n  async getSelectionQuery(selection: Partial<Selection>) {\n    const table = selection.tableId\n      ? await this.base.getTableById(selection.tableId)\n      : undefined;\n    const result = {\n      table: table,\n      view: selection.viewId\n        ? await table?.getViewById(selection.viewId)\n        : undefined,\n      field: selection.fieldId\n        ? await table?.getFieldById(selection.fieldId)\n        : undefined,\n      record: selection.recordId\n        ? await table?.getRecordById(selection.recordId)\n        : undefined,\n    };\n    return result;\n  }\n\n  async getSelection2({\n    viewId = false,\n    fieldId = false,\n    recordId = false,\n  } = {}) {\n    const selection = await this.getSelection();\n    return await this.getSelectionQuery({\n      viewId: viewId ? selection.viewId : undefined,\n      fieldId: fieldId ? selection.fieldId : undefined,\n      recordId: recordId ? selection.recordId : undefined,\n    });\n  }\n}\n","import { createContext, useEffect, useRef, useState } from \"react\";\nimport { BsORM } from \"../../BsORM\";\nimport { Form, Spin } from \"@douyinfe/semi-ui\";\nimport { BaseFormProps } from \"@douyinfe/semi-ui/lib/es/form\";\n\nexport const Context = createContext<{ orm?: BsORM }>({\n  orm: undefined,\n});\n\nexport type BProvideProps = {\n  orm: BsORM;\n  formProps?: BaseFormProps;\n  children: JSX.Element | JSX.Element[];\n  loadingText?: string;\n};\n\nexport default function BProvide(props: BProvideProps) {\n  const [ctx, setCtx] = useState({ orm: props.orm });\n  const [init, setInit] = useState(false);\n  useEffect(() => {\n    const clear = props.orm.initEmitter.on(() => {\n      console.log(\"init\", props.orm);\n      setInit(true);\n    });\n    return clear;\n  }, []);\n\n  return (\n    <Context.Provider value={ctx}>\n      <Form {...props.formProps}>\n        {init ? (\n          props.children\n        ) : (\n          <div\n            style={{\n              height: \"500px\",\n              display: \"flex\",\n              justifyContent: \"center\",\n              alignItems: \"center\",\n              flexDirection: \"column\",\n            }}\n          >\n            <Spin size=\"large\"></Spin>\n            <div style={{ fontSize: \"14px\", color: \"#333\", marginTop: \"5px\" }}>\n              {props.loadingText || \"loading...\"}\n            </div>\n          </div>\n        )}\n      </Form>\n    </Context.Provider>\n  );\n}\n","import { IField, ITable } from \"@lark-base-open/js-sdk\";\nimport { BIField, BsSdk } from \"./BsSdk\";\nimport { Emitter } from \"./Emitter\";\n\nexport type Model = {\n  table: ITable;\n  fields: BIField[];\n};\n\nexport class BsORM {\n  public models: Map<string, Model> = new Map();\n  public activeModel: string | undefined;\n  public initEmitter = new Emitter();\n  constructor(public sdk: BsSdk) {\n    sdk.getTableList().then(async (tables) => {\n      await Promise.all(\n        tables.map(async (table) => {\n          const fields = await sdk.getFieldList(table);\n          this.models.set(table.id, { table, fields: fields });\n        })\n      );\n      const activeTable = await sdk.getActiveTable();\n      this.activeModel = activeTable?.id;\n      this.initEmitter.emitLifeCycle();\n    });\n\n    sdk.selectionChangeEmitter.on(async (event) => {\n      this.activeModel = event.data.tableId as string;\n    });\n  }\n\n  getRecord(recordId: string) {\n    return this.sdk\n      .getRecordById(this.active.table, recordId)\n      .then((record) => record.fields);\n  }\n\n  get active(): Model {\n    return this.models.get(this.activeModel!) as Model;\n  }\n\n  async use(table: string | ITable) {\n    await this.initEmitter.wait();\n    if (typeof table === \"string\") {\n      this.activeModel = table;\n      const model = this.models.get(table);\n      if (!model) return;\n      return model.table;\n    }\n    this.activeModel = table.id;\n    return table;\n  }\n\n  getFields() {\n    const table = this.activeModel;\n    if (!table) return undefined;\n    const model = this.models.get(table);\n    if (!model) return undefined;\n    return model.fields as BIField[];\n  }\n\n  getFieldsMap() {\n    const fields = this.getFields();\n    const map = new Map<string, BIField>();\n    fields?.forEach((field) => {\n      map.set(field.id, field);\n    });\n    return map;\n  }\n}\n","import { useContext } from \"react\";\nimport { Context } from \"../b-provide\";\nimport { Form, Select } from \"@douyinfe/semi-ui\";\nimport { SelectProps } from \"@douyinfe/semi-ui/lib/es/select\";\n\nexport type BSelectFieldProps = SelectProps & {\n  field: string;\n  label?: string;\n  otherOptions?: any[];\n  filterOption?: (val: any) => any;\n};\n\nexport default function BSelectField(props: BSelectFieldProps) {\n  const ctx = useContext(Context);\n  const items = (props.otherOptions ?? [])\n    .concat(ctx.orm?.getFields() ?? [])\n    .filter(props.filterOption ?? ((val) => true))\n    .map((field: any) => (\n      <Form.Select.Option key={field.id} value={field.id}>\n        {field.name}\n      </Form.Select.Option>\n    ));\n  return <Form.Select {...props}>{items}</Form.Select>;\n}\n","import * as echarts from \"echarts\";\nimport { useEffect, useRef } from \"react\";\n\nexport default function ECharts(props: any) {\n  const { option } = props;\n  const chartRef = useRef<HTMLDivElement>(null);\n  useEffect(() => {\n    const chart = echarts.init(chartRef.current!);\n    console.log(chart);\n    chart.setOption(option);\n    if (props.refInstance) props.refInstance.current = chart;\n    return () => {\n      chart.dispose();\n    };\n  }, [option, props.refInstance]);\n  return <div ref={chartRef} style={{ width: \"100%\", height: \"100%\" }}></div>;\n}\n","\"use client\";\nimport type { IOpenAttachment } from \"@lark-base-open/js-sdk\";\nimport { useEffect, useState } from \"react\";\n\nexport async function fileToIOpenAttachment(\n  base: any,\n  file: File\n): Promise<IOpenAttachment> {\n  const tokens = await base.batchUploadFile([file]);\n  return {\n    name: file.name,\n    size: file.size,\n    type: file.type,\n    token: tokens[0],\n    timeStamp: file.lastModified,\n  };\n}\n// function downloadFile(file: Blob | MediaSource) {\n//   const downloadLink = document.createElement(\"a\");\n//   downloadLink.href = URL.createObjectURL(file);\n//   downloadLink.download = file.name;\n//   downloadLink.click();\n// }\nexport function fileToURL(file: Blob) {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onload = () => {\n      resolve(reader.result);\n    };\n    reader.onerror = (error) => {\n      reject(error);\n    };\n    reader.readAsDataURL(file);\n  });\n}\nexport async function canvasToFile(\n  canvas: HTMLCanvasElement,\n  fileName: string,\n  fileType = \"image/png\"\n) {\n  // 获取Canvas上的图像数据（这里假设图像数据为DataURL）\n  // const imageDataURL = canvas.toDataURL(fileType);\n\n  // // 将DataURL转换为Blob对象\n  // const blob = dataURLToBlob(imageDataURL);\n\n  const blob: Blob = await new Promise<Blob>((resolve, reject) => {\n    canvas.toBlob(\n      (blob) => {\n        if (!blob) return reject(new Error(\"canvas to blob error\"));\n        resolve(blob);\n      },\n      fileType,\n      1\n    );\n  });\n\n  // 创建File对象\n  const file = new File([blob], fileName, { type: fileType });\n\n  return file;\n}\n// 将DataURL转换为Blob对象的辅助函数\nfunction dataURLToBlob(dataURL: string) {\n  const byteString = atob(dataURL.split(\",\")[1]);\n  const mimeString = dataURL.split(\",\")[0].split(\":\")[1].split(\";\")[0];\n  const arrayBuffer = new ArrayBuffer(byteString.length);\n  const uint8Array = new Uint8Array(arrayBuffer);\n  for (let i = 0; i < byteString.length; i++) {\n    uint8Array[i] = byteString.charCodeAt(i);\n  }\n  return new Blob([arrayBuffer], { type: mimeString });\n}\n\nexport function base64ToFile(\n  base64: string,\n  filename: string,\n  mimeType: string\n) {\n  const arr = base64.split(\",\");\n  const mime = arr[0].match(/:(.*?);/)![1];\n  const bstr = atob(arr[1]);\n  let n = bstr.length;\n  const u8arr = new Uint8Array(n);\n  // eslint-disable-next-line no-plusplus\n  while (n--) {\n    u8arr[n] = bstr.charCodeAt(n);\n  }\n  return new File([u8arr], filename, { type: mimeType });\n}\nexport function downloadFile(file: File) {\n  const downloadLink = document.createElement(\"a\");\n  downloadLink.href = URL.createObjectURL(file);\n  downloadLink.download = file.name;\n  downloadLink.click();\n}\n\nexport function urlToFile(url: string, filename: string, mimeType?: string) {\n  return fetch(url)\n    .then((res) => res.blob())\n    .then(\n      (blob) => new File([blob], filename, { type: mimeType ?? blob.type })\n    );\n}\n\nexport function fileExt(file: string, isDot = true) {\n  const extIdx = file.lastIndexOf(\".\");\n  const [name, ext] =\n    extIdx === -1\n      ? [file, undefined]\n      : [file.slice(0, extIdx), file.slice(extIdx + 1)];\n  return [name, ext ? (isDot ? \".\" : \"\") + ext.toLowerCase() : undefined];\n}\n\nexport function smartFileSizeDisplay(b: number): string {\n  const kb = b / 1024;\n  if (kb < 1) {\n    return b + \"B\";\n  }\n  const mb = kb / 1024;\n  if (mb < 1) {\n    return kb.toFixed(2) + \"KB\";\n  }\n  const gb = mb / 1024;\n  if (gb < 1) {\n    return mb.toFixed(2) + \"MB\";\n  }\n  return gb.toFixed(2) + \"GB\";\n}\n\nexport function smartTimestampDisplay(timestamp: number): string {\n  const date = new Date(timestamp);\n  // const now = new Date();\n  // const diff = now.getTime() - date.getTime();\n  // if (diff < 1000) {\n  //   return \"刚刚\";\n  // }\n  // if (diff < 60 * 1000) {\n  //   return Math.floor(diff / 1000) + \"秒前\";\n  // }\n  // if (diff < 60 * 60 * 1000) {\n  //   return Math.floor(diff / 1000 / 60) + \"分钟前\";\n  // }\n  // if (diff < 24 * 60 * 60 * 1000) {\n  //   return Math.floor(diff / 1000 / 60 / 60) + \"小时前\";\n  // }\n  // if (diff < 7 * 24 * 60 * 60 * 1000) {\n  //   return Math.floor(diff / 1000 / 60 / 60 / 24) + \"天前\";\n  // }\n  return date.toLocaleString();\n}\n\nexport function copyText(url: string) {\n  const input = document.createElement(\"input\");\n  input.value = url;\n  document.body.appendChild(input);\n  input.select();\n  document.execCommand(\"copy\");\n  document.body.removeChild(input);\n}\n\nexport function splitFilename(url: string) {\n  const idx = url.lastIndexOf(\"/\");\n  const idx2 = url.lastIndexOf(\"?\");\n  const name = url.slice(idx + 1, idx2 === -1 ? undefined : idx2);\n  return name;\n}\n\nlet isInit = new Map();\nconst initState = (key: string, state: any) => {\n  if (isInit.has(key)) {\n    return isInit.get(key);\n  }\n  const saved = localStorage.getItem(key);\n  const init = saved ? JSON.parse(saved) : state;\n  isInit.set(key, init);\n  return init;\n};\n\nexport function useKeepState<T>(state: T, id = \"default\") {\n  const key = `keep-state-${id}`;\n  const [data, setData] = useState(initState(key, state));\n\n  useEffect(() => {\n    localStorage.setItem(key, JSON.stringify(data));\n  }, [data, key]);\n\n  return [data, setData] as const;\n}\n\nexport function useDynKeep<T>(state: T) {\n  const [data, setData] = useState(state);\n\n  useEffect(() => {\n    setData(state);\n  }, [state]);\n\n  const save = (id: string) => {\n    localStorage.setItem(id, JSON.stringify(data));\n  };\n\n  const load = (id: string) => {\n    const saved = localStorage.getItem(id);\n    if (saved) {\n      setData(JSON.parse(saved));\n    }\n  };\n\n  return [data, setData, load, save] as const;\n}\n","import { Banner, Button, Form, Space, Spin, Toast } from \"@douyinfe/semi-ui\";\nimport { useState, useEffect, useRef, useCallback } from \"react\";\nimport styles from \"./index.module.css\";\nimport { useTranslation } from \"next-i18next\";\nimport { BsSdk } from \"@/libs/bs-sdk/BsSdk\";\nimport BProvide from \"@/libs/bs-sdk/components/b-provide\";\nimport { BsORM } from \"@/libs/bs-sdk/BsORM\";\nimport BSelectField from \"@/libs/bs-sdk/components/b-select-field\";\nimport Section from \"@douyinfe/semi-ui/lib/es/form/section\";\nimport ECharts from \"@/components/echarts\";\nimport {\n  base64ToFile,\n  downloadFile,\n  fileToIOpenAttachment,\n  useKeepState,\n} from \"@/libs/bs-sdk/shared\";\nimport { FieldType } from \"@lark-base-open/js-sdk\";\n\nconst bsSdk = new BsSdk({\n  onSelectionChange: true,\n  immediatelySelectionChange: true,\n});\n\nconst orm = new BsORM(bsSdk);\n\nexport default function Home() {\n  const [t, i18n] = useTranslation();\n  const echartRef = useRef();\n  const [conf, setConf] = useKeepState<any>({\n    output: { type: \"preview\" },\n    chartType: \"line\",\n    chart: { max: 10, min: 0, order: \"default\", auto: true, showValue: true },\n    format: true,\n    formatCode: {},\n  });\n  const [option, setOption] = useState<any>(\n    createOption(\n      \"line\",\n      {\n        A: 10,\n        B: 0,\n        C: 10,\n      },\n      conf?.chart\n    )\n  );\n\n  const setConfValue = useCallback(\n    (value: any) => {\n      conf.select = value.select;\n      setConf(Object.assign({}, mergeDeep(conf, value)));\n    },\n    [conf, setConf]\n  );\n\n  const uiConf = () => {\n    const map: any = {\n      get bar() {\n        return (\n          <>\n            <Form.Select\n              field=\"chart.order\"\n              label={t(\"chart-conf-order\")}\n              placeholder={t(\"chart-conf-\" + conf.chart.order)}\n              optionList={[\n                { label: t(\"chart-conf-default\"), value: \"default\" },\n                { label: t(\"chart-conf-asc\"), value: \"asc\" },\n                {\n                  label: t(\"chart-conf-desc\"),\n                  value: \"desc\",\n                },\n              ]}\n            ></Form.Select>\n          </>\n        );\n      },\n      get line() {\n        return (\n          <>\n            <Form.Select\n              field=\"chart.order\"\n              label={t(\"chart-conf-order\")}\n              placeholder={t(\"chart-conf-\" + conf.chart.order)}\n              optionList={[\n                { label: t(\"chart-conf-default\"), value: \"default\" },\n                { label: t(\"chart-conf-asc\"), value: \"asc\" },\n                {\n                  label: t(\"chart-conf-desc\"),\n                  value: \"desc\",\n                },\n              ]}\n            ></Form.Select>\n          </>\n        );\n      },\n\n      get radar() {\n        return (\n          <>\n            <Form.Switch\n              field=\"chart.showValue\"\n              label={t(\"chart-conf-showValue\")}\n              defaultValue={conf.chart.showValue}\n              initValue={conf.chart.showValue}\n            ></Form.Switch>\n            <Form.Switch\n              field=\"chart.auto\"\n              label={t(\"chart-conf-auto\")}\n              defaultValue={conf.chart.auto}\n              initValue={conf.chart.auto}\n              onChange={(v) => setConfValue({ chart: { auto: v } })}\n            ></Form.Switch>\n            {!conf.chart?.auto && (\n              <>\n                <Form.InputNumber\n                  field=\"chart.max\"\n                  placeholder={conf.chart.max}\n                  label={t(\"chart-conf-max\")}\n                ></Form.InputNumber>\n                <Form.InputNumber\n                  field=\"chart.min\"\n                  placeholder={conf.chart.min}\n                  label={t(\"chart-conf-min\")}\n                ></Form.InputNumber>\n              </>\n            )}\n          </>\n        );\n      },\n    };\n\n    return map[conf.chartType] || null;\n  };\n\n  // console.log(conf);\n\n  useEffect(() => {\n    // const clear = bsSdk.selectionChangeEmitter.on(async (e) => {\n    //   const { record, field } = await bsSdk.getSelectionQuery(e.data);\n    //   console.log(\"record\", record);\n    //   console.log(\"field\", field);\n    //   console.log(e);\n    // });\n    // return clear;\n    console.log(\"useEffect\");\n    bsSdk.bitable.bridge.getLanguage().then((lang) => {\n      i18n.changeLanguage(lang.includes(\"zh\") ? \"zh\" : \"en\");\n    });\n  }, []);\n\n  const onSubmit = useCallback(\n    async (nconf: any) => {\n      console.log(\n        nconf,\n        echartRef\n        // downloadFile(base64ToFile(url, Date.now() + \".png\", \"image/png\"))\n      );\n      conf.select = nconf.select;\n      nconf = mergeDeep(conf, nconf);\n\n      if (nconf.chart.isExpr) {\n        nconf.chart.expr = nconf.chart.expr || {};\n        for (let i = 0; i < nconf.select.length; i++) {\n          const fieldId = nconf.select[i];\n          if (!nconf.chart.expr[fieldId]) {\n            nconf.chart.expr[fieldId] = \"x\";\n          }\n        }\n      } else {\n        nconf.chart.expr = {};\n      }\n      if (Object.keys(nconf?.select || {}).length === 0)\n        return Toast.error(t(\"toast-select-number-field\"));\n      let load = Toast.info({\n        icon: <Spin />,\n        content: `${t(\"toast-gening\")}...`,\n        duration: 0,\n      });\n      let recordId = \"\";\n      if (nconf.output.type !== \"multiToField\") {\n        const select = await bsSdk.getSelection();\n        console.log({ select });\n\n        if (select.recordId) {\n          recordId = select.recordId as string;\n        } else {\n          if (nconf?.output?.type === \"preview\") {\n            recordId = await (await bsSdk.getActiveTable())\n              .getRecords({ pageSize: 1 })\n              .then((res) => res.records[0].recordId);\n          }\n        }\n      }\n      console.log({ recordId });\n\n      if (nconf.output.type === \"multiToField\") {\n        const recordIds = await bsSdk.getRecordIds();\n        if (!recordIds.length) return Toast.error(t(\"toast-add-record\"));\n        for (let i = 0; i < recordIds.length; i++) {\n          Toast.close(load);\n          load = Toast.info({\n            icon: <Spin />,\n            content: `${t(\"toast-gening\")}(${i + 1}/${recordIds.length})...`,\n            duration: 0,\n          });\n          const recordId = recordIds[i];\n          const url = await gene(recordId);\n          if (!url) continue;\n          const outfield = orm.getFieldsMap().get(nconf.output.field);\n          if ((await outfield?.getType()) !== FieldType.Attachment) {\n            Toast.close(load);\n            return Toast.error(t(\"toast-select-field\"));\n          }\n          outfield?.setValue(recordId, [\n            await fileToIOpenAttachment(\n              bsSdk.base,\n              base64ToFile(url, Date.now() + \".png\", \"image/png\")\n            ),\n          ]);\n        }\n      } else if (nconf.output.type === \"toField\") {\n        if (!recordId) {\n          Toast.close(load);\n          return Toast.error(t(\"toast-select-record\"));\n        }\n\n        const url = await gene(recordId);\n\n        const outfield = orm.getFieldsMap().get(nconf.output.field);\n        if ((await outfield?.getType()) !== FieldType.Attachment) {\n          Toast.close(load);\n          return Toast.error(t(\"toast-select-field\"));\n        }\n        outfield?.setValue(recordId, [\n          await fileToIOpenAttachment(\n            bsSdk.base,\n            base64ToFile(url, Date.now() + \".png\", \"image/png\")\n          ),\n        ]);\n      } else {\n        if (!recordId) {\n          Toast.close(load);\n          return Toast.error(t(\"toast-select-record\"));\n        }\n        await gene(recordId);\n      }\n      Toast.close(load);\n      Toast.success(t(\"toast-gene-success\"));\n\n      async function gene(recordId: string) {\n        const record = await orm.getRecord(recordId);\n        const selectFieldRecord = nconf.select.reduce(\n          (map: any, fieldId: string) => {\n            let v = toDisplay(record[fieldId]);\n            if (!v) {\n              v = 0;\n            }\n            v = Number(v);\n            // console.log(\"select\", v, fieldId, record[fieldId]);\n\n            if (typeof v === \"number\" && v === v) {\n              map[orm.getFieldsMap()?.get(fieldId)?.name as string] = nconf\n                .chart?.expr?.[fieldId]\n                ? parseExpr(nconf.chart.expr[fieldId], { x: v }, () => v)\n                : v;\n            }\n            return map;\n          },\n          {}\n        );\n\n        if (Object.keys(selectFieldRecord).length === 0) {\n          return;\n        }\n\n        setOption(\n          createOption(\n            nconf.chartType,\n            selectFieldRecord,\n            nconf?.chart,\n            toDisplay(record[nconf.selectLabel])\n          )\n        );\n        console.log(\n          record,\n          selectFieldRecord,\n          nconf.selectLabel,\n          record[nconf.selectLabel]\n        );\n\n        await new Promise((resolve) => setTimeout(resolve, 1));\n        const url = (echartRef.current as any)?.getDataURL();\n        return url;\n      }\n    },\n    [conf, t]\n  );\n\n  const onChange = useCallback(\n    (e: any) => {\n      // console.log(\"onChange\", e);\n      setConfValue(e.values);\n    },\n    [setConfValue]\n  );\n\n  function createOption(\n    chartType: string,\n    data: any,\n    opt: any = {},\n    label?: any\n  ) {\n    console.log(\"createOption\", chartType, data, opt, label);\n\n    let keys = Object.keys(data);\n    const maxKeyLen = Math.max(...keys.map((key) => key.length));\n    if (opt.order === \"asc\" || opt.order === \"desc\") {\n      keys = extractAndSortNumbers(keys);\n      if (opt.order === \"desc\") {\n        keys = keys.reverse();\n      }\n    }\n    if (opt.auto && keys.length) {\n      opt.max = Math.max(...keys.map((key) => data[key]));\n      opt.min = 0;\n    }\n    return (\n      (\n        {\n          get line() {\n            return {\n              wrapStyle: {\n                width: `${(keys.length ?? 0) * 100 + 100}px`,\n                height: `500px`,\n              },\n              animation: false,\n              xAxis: {\n                type: \"category\",\n                data: keys,\n              },\n              yAxis: {\n                type: \"value\",\n              },\n              series: [\n                {\n                  data: keys.map((key) => data[key]),\n                  type: \"line\",\n                },\n              ],\n            };\n          },\n          get bar() {\n            return {\n              wrapStyle: {\n                width: `${(keys.length ?? 0) * 100 + 100}px`,\n                height: `500px`,\n              },\n\n              animation: false,\n              xAxis: {\n                type: \"category\",\n                data: keys,\n              },\n              yAxis: {\n                type: \"value\",\n              },\n              series: [\n                {\n                  data: keys.map((key) => data[key]),\n                  type: \"bar\",\n                },\n              ],\n            };\n          },\n          get radar() {\n            const maxVal = Math.max(...keys.map((key) => data[key]));\n            return {\n              wrapStyle: {\n                width: `500px`,\n                height: `500px`,\n              },\n\n              backgroundColor: \"#fff\",\n\n              animation: false,\n              // title: {\n              //   text: label,\n              //   textAlign: \"center\",\n              // },\n              legend: {\n                // data: [\"Allocated Budget\", \"Actual Spending\"],\n              },\n              textStyle: {\n                fontSize: 16,\n              },\n              radar: {\n                // shape: 'circle',\n                // indicator: [\n                //   { name: \"Sales\" },\n                //   { name: \"Administration\" },\n                //   { name: \"Information Technology\" },\n                //   { name: \"Customer Support\" },\n                //   { name: \"Development\" },\n                //   { name: \"Marketing\" },\n                // ],\n                indicator: keys.map((key) => ({\n                  name: key,\n                  max: data[key] > opt.max ? data[key] : opt.max,\n                  min: opt.min,\n                  color: data[key] > opt.max ? \"red\" : undefined,\n                  // key.length > 6\n                  //   ? key.slice(0, 6) + \"\\n\" + key.slice(6, key.length)\n                  //   : key,\n                })),\n                axisName: {\n                  color: \"#5470c6\",\n                },\n                center: [\"50%\", \"50%\"], // 将雷达图居中显示\n                radius: maxKeyLen > 5 ? \"50%\" : maxKeyLen > 4 ? \"60%\" : \"70%\", // 设置雷达图的半径为容器高度的70%\n              },\n              series: [\n                {\n                  name: \"Budget vs spending\",\n                  type: \"radar\",\n                  data: [\n                    {\n                      value: keys.map((key) => data[key]),\n                      areaStyle: {\n                        color: \"rgba(66, 139, 212, 0.3)\",\n                      },\n                      label: {\n                        show: opt.showValue,\n                        position: \"inside\",\n                      },\n                      name: label,\n                    },\n                    // {\n                    //   value: [4200, 3000, 20000, 35000, 50000, 18000],\n                    //   name: \"Allocated Budget\",\n                    // },\n                    // {\n                    //   value: [5000, 14000, 28000, 26000, 42000, 21000],\n                    //   name: \"Actual Spending\",\n                    // },\n                  ],\n                },\n              ],\n            };\n          },\n        } as any\n      )[chartType] || {}\n    );\n  }\n\n  return (\n    <main className={styles.main}>\n      <BProvide\n        orm={orm}\n        formProps={{\n          onSubmit,\n          onChange,\n          labelPosition: \"left\",\n          initValues: conf,\n        }}\n        loadingText={t(\"init\")}\n      >\n        <Section text={t(\"field-conf\")} style={{ marginTop: \"10px\" }}>\n          <BSelectField\n            field=\"select\"\n            label={t(\"select-field\")}\n            placeholder={t(\"select-field-tip\")}\n            multiple\n          ></BSelectField>\n          <BSelectField\n            field=\"selectLabel\"\n            label={t(\"label-field\")}\n            placeholder={t(\"select-field-any-tip\")}\n            filterOption={(field) => field?.type !== FieldType.Number}\n            otherOptions={[\n              {\n                id: \"none\",\n                name: \"不显示\",\n              },\n            ]}\n          ></BSelectField>\n        </Section>\n        <Section text={t(\"chart-conf\")} style={{ marginTop: \"10px\" }}>\n          <Form.Select\n            field=\"chartType\"\n            label={t(\"chart-conf-type\")}\n            optionList={[\n              { label: t(\"chart-conf-line\"), value: \"line\" },\n              { label: t(\"chart-conf-bar\"), value: \"bar\" },\n              { label: t(\"chart-conf-radar\"), value: \"radar\" },\n            ]}\n            onChange={(v: any) => {\n              console.log(v);\n              setConfValue({ chartType: v });\n              // setOption(createOption(v, , opt))\n            }}\n          ></Form.Select>\n          <Form.Switch\n            field=\"chart.isExpr\"\n            label={t(\"chart-conf-expr\")}\n            defaultValue={conf.chart.isExpr}\n            initValue={conf.chart.isExpr}\n            onChange={(v) => setConfValue({ chart: { isExpr: v } })}\n          ></Form.Switch>\n          {conf.chart?.isExpr &&\n            conf.select?.map((fieldId: string) => (\n              <Form.Input\n                key={fieldId}\n                field={`chart.expr.${fieldId}`}\n                label={orm.getFieldsMap()?.get(fieldId)?.name}\n                placeholder=\"x\"\n              ></Form.Input>\n            ))}\n          {uiConf()}\n        </Section>\n        <Section text={t(\"output-conf\")} style={{ marginTop: \"10px\" }}>\n          <Form.Select field=\"output.type\" label={t(\"output-type\")}>\n            <Form.Select.Option value={\"preview\"}>\n              {t(\"priview\")}\n            </Form.Select.Option>\n            <Form.Select.Option value={\"toField\"}>\n              {t(\"gene-to-field\")}\n            </Form.Select.Option>\n            <Form.Select.Option value={\"multiToField\"}>\n              {t(\"gene-multi-to-field\")}\n            </Form.Select.Option>\n          </Form.Select>\n          {conf?.output && conf?.output?.type !== \"preview\" && (\n            <>\n              <BSelectField\n                field=\"output.field\"\n                filterOption={(field) => field?.type === FieldType.Attachment}\n                label={t(\"output-field\")}\n                placeholder={t(\"output-field-tip\")}\n              ></BSelectField>\n              <Banner\n                type=\"danger\"\n                description={t(\"output-field-danger\")}\n                style={{ marginBottom: \"10px\" }}\n              />\n            </>\n          )}\n        </Section>\n        <Space>\n          <Button htmlType=\"submit\" block type=\"primary\">\n            {t(\"btn-gene\")}\n          </Button>\n          <Button\n            type=\"secondary\"\n            block\n            onClick={() => open(\"https://zhuanlan.zhihu.com/p/669107200\")}\n          >\n            {t(\"btn-help\")}\n          </Button>\n        </Space>\n        <div style={{ width: \"100%\", overflow: \"scroll\" }}>\n          <div style={option.wrapStyle}>\n            <ECharts refInstance={echartRef} option={option}></ECharts>\n          </div>\n        </div>\n      </BProvide>\n    </main>\n  );\n}\n\nfunction toDisplay(cell: any) {\n  return typeof cell === \"object\"\n    ? cell?.text ??\n        cell\n          ?.map?.((item: any) => item?.text ?? item?.name)\n          .filter((item: any) => item)\n          .join(\",\")\n    : cell;\n}\n\nfunction extractAndSortNumbers(strings: any[]) {\n  // 定义中文数字映射\n  const chineseNumberMap: any = {\n    零: 0,\n    一: 1,\n    二: 2,\n    三: 3,\n    四: 4,\n    五: 5,\n    六: 6,\n    七: 7,\n    八: 8,\n    九: 9,\n    十: 10,\n    百: 100,\n    千: 1000,\n    万: 10000,\n    亿: 100000000,\n  };\n\n  // 中文数字转阿拉伯数字\n  function chineseToNumber(chineseStr: string) {\n    let total = 0;\n    let temp = 0;\n    let prevUnit = 1;\n\n    for (const char of chineseStr.split(\"\")) {\n      let value = chineseNumberMap[char];\n      if (value < 10) {\n        temp = value;\n      } else {\n        if (temp === 0) temp = 1;\n        if (value > prevUnit) {\n          total += temp;\n          total *= value;\n          temp = 0;\n        } else {\n          total += temp * value;\n        }\n        prevUnit = value;\n        temp = 0;\n      }\n    }\n    return total + temp;\n  }\n\n  // 提取数字并映射为数字值的函数\n  function extractNumber(str: string) {\n    const numberPattern = /(\\d+|[零一二三四五六七八九十百千万亿]+)/g;\n    const matches = str.match(numberPattern);\n    if (!matches) return 0;\n\n    return matches.reduce((sum: number, match: string) => {\n      return (\n        sum + (isNaN(Number(match)) ? chineseToNumber(match) : Number(match))\n      );\n    }, 0);\n  }\n\n  // 排序函数，将包含数字的词进行排序\n  function sortWithNumbers(a: any, b: any) {\n    const numA = extractNumber(a);\n    const numB = extractNumber(b);\n    return numA - numB;\n  }\n\n  // 使用排序函数对字符串数组进行排序\n  return strings.slice().sort(sortWithNumbers);\n}\n\nfunction mergeDeep(a: any, b: any) {\n  const keys = Object.keys(b);\n  const len = keys.length;\n  for (let i = 0; i < len; i++) {\n    const key = keys[i];\n    if (typeof b[key] === \"object\") {\n      if (typeof a[key] === \"object\") {\n        mergeDeep(a[key], b[key]);\n      } else {\n        a[key] = b[key];\n      }\n    } else {\n      a[key] = b[key];\n    }\n  }\n  return a;\n}\n\nfunction parseExpr(expr: string, ctx: any, cb: any) {\n  // 运行expr\n  try {\n    return new Function(\"ctx\", `with(ctx){return ${expr}}`)(ctx);\n  } catch (error) {\n    return cb();\n  }\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"Home_main__ElU3j\",\"h4\":\"Home_h4__4GCIr\",\"code\":\"Home_code__ESbU9\"};"],"names":["Emitter","emitSync","_len","arguments","length","args","_key","events","forEach","cb","emitLifeCycle","lastEmitArgs","Promise","resolve","then","error","reject","emit","on","add","off","wait","clear","delete","destroy","constructor","Set","BsSdk","getRecordIds","table","getActiveTable","getRecordIdList","getRecordById","recordId","activeTable","bitable","base","getTableList","getFieldList","fieldList","i","field","name","getName","getSelection","getSelectionQuery","selection","tableId","getTableById","undefined","result","view","viewId","getViewById","fieldId","getFieldById","record","getSelection2","onSelectionChange","immediatelySelectionChange","selectionChangeEmitter","event","data","Context","createContext","orm","BProvide","props","ctx","setCtx","useState","init","setInit","useEffect","initEmitter","console","log","jsx_runtime","jsx","Provider","value","Form","formProps","children","jsxs","div","style","height","display","justifyContent","alignItems","flexDirection","Spin","size","fontSize","color","marginTop","loadingText","BsORM","getRecord","sdk","active","fields","models","get","activeModel","use","model","id","getFields","getFieldsMap","map","Map","set","tables","all","BSelectField","useContext","items","otherOptions","concat","filter","filterOption","Select","Option","ECharts","option","chartRef","useRef","chart","echarts","current","setOption","refInstance","dispose","ref","width","fileToIOpenAttachment","file","tokens","batchUploadFile","type","token","timeStamp","lastModified","base64ToFile","base64","filename","mimeType","arr","split","match","bstr","atob","n","u8arr","Uint8Array","charCodeAt","File","isInit","initState","key","state","has","saved","localStorage","getItem","JSON","parse","useKeepState","setData","setItem","stringify","bsSdk","Home","conf","t","i18n","useTranslation","echartRef","setConf","output","chartType","max","min","order","auto","showValue","format","formatCode","createOption","A","B","C","setConfValue","useCallback","select","Object","assign","mergeDeep","bridge","getLanguage","changeLanguage","lang","includes","onSubmit","nconf","isExpr","expr","keys","Toast","load","info","icon","content","duration","getRecords","pageSize","res","records","recordIds","close","url","gene","outfield","getType","FieldType","Attachment","setValue","Date","now","selectFieldRecord","reduce","v","toDisplay","Number","parseExpr","x","selectLabel","setTimeout","_echartRef_current","getDataURL","success","onChange","e","values","opt","label","maxKeyLen","Math","extractAndSortNumbers","reverse","line","wrapStyle","animation","xAxis","yAxis","series","bar","radar","backgroundColor","legend","textStyle","indicator","axisName","center","radius","areaStyle","show","position","main","className","styles","labelPosition","initValues","Section","text","placeholder","multiple","optionList","Switch","defaultValue","initValue","Input","Fragment","InputNumber","Banner","description","marginBottom","Space","Button","htmlType","block","onClick","open","overflow","cell","item","join","strings","chineseNumberMap","零","一","二","三","四","五","六","七","八","九","十","百","千","万","亿","chineseToNumber","chineseStr","total","temp","prevUnit","char","extractNumber","str","matches","sum","isNaN","sortWithNumbers","a","b","numA","numB","slice","sort","len","module","exports"],"sourceRoot":""}